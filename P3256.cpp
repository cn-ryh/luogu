//P3256 write by cn_ryh