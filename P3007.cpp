//P3007 write by cn_ryh