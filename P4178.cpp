//P4178 write by cn_ryh