//P3870 write by cn_ryh