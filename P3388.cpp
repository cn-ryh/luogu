//P3388 write by cn_ryh