// P3846 write by cn_ryh